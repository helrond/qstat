<div class="teamSelect" ng-controller="statCtrl">
    <div class="title">
        <h2>Record Stats</h2>
    </div>
    <select class="form-control" ng-model="selectedGame" ng-options="game.name for game in games"
        ng-hide="selectedGame">
        <option value="">-- Select a game --</option>
    </select>
        <div class="start" ng-show="selectedGame && !record">
            <button class="btn btn-lg btn-success" ng-click="record = true; startTime()">Start</button>
            <p class="help-block">Timer will start for {{ selectedGame.name }}</p>
        </div>
        <div ng-show="record && !confirm" class="record">
            <div class="col-xs-12">
                <h4>Possession</h4>
                <div class="radio">
                    <label>
                        <input id="team1" name="switch" type="radio" value="{{selectedGame.teams[0]._id}}" ng-model="possessionTeam" ng-click="AddPossession()">
                        {{selectedGame.teams[0].name}}
                    </label>
                </div>
                <div class="radio">
                    <label>
                        <input id="team2" type="radio" value="{{selectedGame.teams[1]._id}}" ng-model="possessionTeam" ng-click="AddPossession()">
                            {{selectedGame.teams[1].name}}
                    </label>
                </div>
                <hr/>
            </div>
            <form name="stat">
                <div class="form-group col-xs-12">
                    <label class="sr-only">Team</label>
                    <select name="team" class="form-control" ng-model="selectedTeam"
                        ng-options="team.name for team in teams | filter:selectedPlayer.team.name" required><!--filter by name in selectedGame.teams-->
                        <option value="">-- Select a team --</option>
                    </select>
                </div>
                <div class="form-group col-xs-12">
                    <label class="sr-only">Position</label>
                    <select class="form-control" ng-model="selectedPosition" 
                        ng-options="position.name for position in positions | filter:selectedPlayer.position" required><!-- also by values in selectedStat.role -->
                        <option value="">-- Select a position --</option>
                    </select>
                </div>
                {{selectedTeam}}
                <div class="form-group col-xs-8">
                    <label class="sr-only">Player Name</label>
                    <select ng-model="selectedPlayer" class="form-control"
                        ng-options="player.name for player in players | filter:selectedPosition.name"  required><!-- also filter by each name in selectedTeam.players -->
                        <option value="">-- Select a player --</option>
                    </select>
                </div>
                <div class="form-group col-xs-4">
                    <label class="sr-only">Player Number</label>
                    <select ng-model="selectedPlayer" class="form-control"
                        ng-options="player.number for player in players | filter:selectedPosition.name" required><!-- also filter by each name in selectedTeam.players -->
                        <option value="">-- Select a number --</option>
                    </select>
                </div>
                <div class="col-xs-12">
                <div class="form-group col-xs-5">
                    <label class="sr-only">Statistic Name</label>
                    <select class="form-control" ng-model="selectedStat" 
                        ng-options="statistic.primaryName for statistic in statistics | filter:selectedPosition.name | filter:selectedPlayer.position.name" required>
                        <option value="">-- Select a statistic --</option>
                    </select>
                </div>
                <div class="form-group col-xs-5">
                    <label ng-show="selectedStat.double">
                    <input type="checkbox" ng-model="success" value="statistic.secondaryName"/>
                        Success?
                    </label>
                </div>
                <div class="form-group col-xs-2">
                    <label class="sr-only">Statistic Attribute</label>
                    <div class="form-inline" ng-show="selectedStat.primaryName === 'Goal Attempt'">
                        <div class="radio">
                            <label>
                                <input type="radio" value="drive" ng-model="selectedStat.attribute">
                                    Drive
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" value="shot" ng-model="selectedStat.attribute">
                                    Shot
                            </label>
                        </div>
                    </div>
                </div>
                </div>
                <!--<p class="help-block text-center" ng-hide="stat.$error.required" ng-model="stat">{{selectedStat.name}}&nbsp;by&nbsp;{{selectedPlayer.name}}&nbsp;({{selectedPosition.name}}/#{{selectedPlayer.number}})
                    of {{selectedTeam.name}}</p>-->
                <button ng-show="stat.$error.required" class="btn btn-primary center-block" disabled="disabled">Add</button>
                <button ng-hide="stat.$error.required" class="btn btn-primary center-block" ng-click="Add()">Add</button>
            </form>
            <div>
                <p>Game started at {{startTime | date:'h:mm:ss a'}}</p>
                <table ng-model="selectedGame.statistics" class="table table-striped col-xs-12">
                    <tr>
                        <th class="col-xs-3">Player</th>
                        <th class="col-xs-2">Position</th>
                        <th class="col-xs-3">Team</th>
                        <th class="col-xs-2">Statistic</th>
                        <th class="col-xs-2">Time</th>
                    </tr>
                    <tr ng-repeat="stat in selectedGame.statistics">
                        <td class="col-xs-3">{{stat.player.name}}</td>
                        <td class="col-xs-2">{{stat.position.name}}</td>
                        <td class="col-xs-3">{{stat.team.name}}</td>
                        <td class="col-xs-2">{{stat.name}}<span ng-show="selectedStat.attribute">, {{stat.attribute}}</span></td>
                        <td class="col-xs-2">{{stat.time | date:'h:mm:ss a'}}</td>
                        <td class="text-danger pull-right"><span class="glyphicon glyphicon-remove" ng-click="Delete(stat)"></span></td>
                    </tr>
                </table>
            </div>
            <button class="btn btn-lg btn-danger center-block" ng-click="confirm = true; endTime(); gameTime();">Stop</button>
            <p class="help-block text-center">Timer will stop for {{selectedGame.name}}</p>
        </div>

        <div ng-show="confirm">
            <h3>{{selectedGame.name}}</h3>
            <!--<p>{{startTime | date:'MMMM dd, yyyy h:mm:ss a'}} - {{endTime | date:'h:mm:ss a'}}.</p>-->
            <p>Game Time: {{gameTime | date:'mm:ss'}}</p>
            <table ng-model="selectedGame.statistics" class="table table-striped col-xs-12">
                <tr>
                    <th class="col-xs-3">Player</th>
                    <th class="col-xs-2">Position</th>
                    <th class="col-xs-3">Team</th>
                    <th class="col-xs-2">Statistic</th>
                    <th class="col-xs-2">Time</th>
                </tr>
                <tr ng-repeat="stat in selectedGame.statistics">
                    <td class="col-xs-3">{{stat.player.name}}</td>
                    <td class="col-xs-2">{{stat.position.name}}</td>
                    <td class="col-xs-3">{{stat.team.name}}</td>
                    <td class="col-xs-2">{{stat.name}}</td>
                    <td class="col-xs-2">{{stat.time | date:'h:mm:ss a'}}</td>
                    <td class="text-danger pull-right"><span class="glyphicon glyphicon-remove" ng-click="Delete(stat)"></span></td>
                </tr>
            </table>
            <button class="btn btn-lg btn-primary" ng-click="Confirm()">Confirm</button>
            <a href="#/" class="btn btn-lg btn-danger">Cancel</a>
        </div>
</div>
