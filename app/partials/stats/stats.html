<div class="teamSelect" ng-controller="gameCtrl">
    <div class="title">
        <h2>Record Stats</h2>
    </div>
    <select class="form-control" ng-model="selectedGame" ng-options="game.name for game in games"
        ng-hide="selectedGame">
        <option value="">-- Select a game --</option>
    </select>

    <div ng-controller="statCtrl">
        <div class="start" ng-show="selectedGame && !record">
            <button class="btn btn-lg btn-success" ng-click="record = true; startTime()">Start</button>
            <p class="help-block">Timer will start for {{ selectedGame.name }}</p>
        </div>
        <div ng-show="record && !confirm" class="record">
            <form name="possession">
                <div class="form-group col-xs-9">
                    <select name="team" class="form-control col-xs-10" ng-model="possessionTeam"
                        ng-options="team.name for team in selectedGame.teams" required>
                        <option value="">-- Who has possession? --</option>
                    </select>
                </div>
                <button ng-show="possession.$error.required" class="btn btn-sm btn-primary" disabled="disabled">Add</button>
                <button ng-hide="possession.$error.required" class="btn btn-sm btn-primary" ng-click="AddPossession()">Add</button>
            </form>
            <form name="stat">
                <div class="form-group col-xs-12">
                    <label class="sr-only">Team</label>
                    <select name="team" class="form-control" ng-model="selectedTeam"
                        ng-options="team.name for team in selectedGame.teams | filter:selectedPlayerName.team" required>
                        <option value="">-- Select a team --</option>
                    </select>
                </div>
                <div class="form-group col-xs-12">
                    <label class="sr-only">Position</label>
                    <select class="form-control" ng-model="selectedPosition" 
                        ng-options="position.name for position in positions | filter:selectedPlayer.position:selectedStat.role" required> <!--may need to write custom filter, or create a filtered scope: http://stackoverflow.com/questions/15259732/angularjs-filter-multiple-select-inputs-->
                        <option value="">-- Select a position --</option>
                    </select>
                </div>
                <div class="form-group col-xs-8">
                    <label class="sr-only">Player Name</label>
                    <select ng-model="selectedPlayer" class="form-control"
                        ng-options="player.name for player in players | filter:selectedPosition.name" required><!-- also filter by selectedTeam -->
                        <option value="">-- Select a player --</option>
                    </select>
                </div>
                <div class="form-group col-xs-4">
                    <label class="sr-only">Player Number</label>
                    <select ng-model="selectedPlayer" class="form-control"
                        ng-options="player.number for player in players | filter:selectedPosition.name" required><!-- also filter by selectedTeam -->
                        <option value="">-- Select a number --</option>
                    </select>
                </div>
                <div class="form-group col-xs-8">
                    <label class="sr-only">Statistic Name</label>
                    <select class="form-control" ng-model="selectedStat" 
                        ng-options="statistic.name for statistic in statistics | filter:selectedPosition.name:selectedPlayer.position" required><!--custom filter or filtered scope required -->
                        <option value="">-- Select a statistic --</option>
                    </select>
                </div>
                <div class="form-group col-xs-2">
                    <label class="sr-only">Statistic Value</label>
                    <select class="form-control" ng-model="selectedStat" 
                        ng-options="statistic.type for statistic in statistics | filter:selectedPosition.name:selectedPlayer.position" required><!--custom filter or filtered scope required -->
                        <option value="">-- Select a value --</option>
                    </select>
                </div>
                <div class="form-group col-xs-2">
                    <label class="sr-only">Statistic Attribute</label>
                    <select class="form-control" ng-model="selectedStat" 
                        ng-options="statistic.attribute.name for statistic in statistics | filter:selectedPosition.name:selectedPlayer.position" required><!--custom filter or filtered scope required -->
                        <option value="">-- Select a value --</option>
                    </select>
                </div>
                <p class="help-block text-center" ng-hide="stat.$error.required" ng-model="stat">{{selectedStat.name}}&nbsp;by&nbsp;{{selectedPlayer.name}}&nbsp;({{selectedPosition.name}}/#{{selectedPlayer.number}})
                    of {{selectedTeam.name}}</p>
                <button ng-show="stat.$error.required" class="btn btn-primary center-block" disabled="disabled">Add</button>
                <button ng-hide="stat.$error.required" class="btn btn-primary center-block" ng-click="Add()">Add</button>
            </form>
            <div>
                <p>Game started at {{startTime | date:'h:mm:ss a'}}</p>
                <table ng-model="stats" class="table table-striped col-xs-12">
                    <tr>
                        <th class="col-xs-3">Player</th>
                        <th class="col-xs-2">Position</th>
                        <th class="col-xs-3">Team</th>
                        <th class="col-xs-2">Statistic</th>
                        <th class="col-xs-2">Time</th>
                    </tr>
                    <tr ng-repeat="stat in stats">
                        <td class="col-xs-3">{{stat.player.name}}</td>
                        <td class="col-xs-2">{{stat.position.name}}</td>
                        <td class="col-xs-3">{{stat.team.name}}</td>
                        <td class="col-xs-2">{{stat.statistic.name}}, {{stat.statistic.value}}</td>
                        <td class="col-xs-2">{{stat.time | date:'h:mm:ss a'}}</td>
                        <td class="text-danger pull-right"><span class="glyphicon glyphicon-remove"></span></td>
                    </tr>
                </table>
            </div>
            <button class="btn btn-lg btn-danger center-block" ng-click="confirm = true; endTime(); gameTime();">Stop</button>
            <p class="help-block text-center">Timer will stop for {{selectedGame.name}}</p>
        </div>

        <div ng-show="confirm">
            <h3>{{selectedGame.name}}</h3>
            <p>{{startTime | date:'MMMM dd, yyyy h:mm:ss a'}} - {{endTime | date:'h:mm:ss a'}}.</p>
            <p>Game Time: {{gameTime | date:'mm:ss'}}</p>
            <table ng-model="stats" class="table table-striped col-xs-12">
                <tr>
                    <th class="col-xs-3">Player</th>
                    <th class="col-xs-2">Position</th>
                    <th class="col-xs-3">Team</th>
                    <th class="col-xs-2">Statistic</th>
                    <th class="col-xs-2">Time</th>
                </tr>
                <tr ng-repeat="stat in stats">
                    <td class="col-xs-3">{{stat.player.name}}</td>
                    <td class="col-xs-2">{{stat.position.name}}</td>
                    <td class="col-xs-3">{{stat.team.name}}</td>
                    <td class="col-xs-2">{{stat.statistic.name}}, {{stat.statistic.value}}</td>
                    <td class="col-xs-2">{{stat.time | date:'h:mm:ss a'}}</td>
                    <td class="text-danger pull-right"><span class="glyphicon glyphicon-remove"></span></td>
                </tr>
            </table>
            <button class="btn btn-lg btn-primary">Confirm</button>
        
        </div>
        <!-- 
   
       Tie teams and players together (filter in control?)
       Tie players and numbers together
        
       get stats list from Json array?
    
    
    -->
    </div>
</div>
